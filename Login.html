<!DOCTYPE html>
<html lang="en">
<head>
    <title>Ayurcare | Login</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
    <div class="container mt-5" style="max-width: 400px; text-align: center;">
        <img src="image.png" alt="Logo" style="width: 80px;" class="mb-3">
        <h1 class="text-success">Ayurcare</h1>
        <div class="card shadow p-4 mt-3">
            <form id="loginForm">
                <div class="mb-3 text-start">
                    <label class="form-label">Email</label>
                    <input type="email" id="userEmail" class="form-control" required>
                </div>
                <div class="mb-3 text-start">
                    <label class="form-label">Password</label>
                    <input type="password" id="userPass" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-primary w-100">Login</button>
            </form>
            <p class="mt-3">New user? <a href="./Register.html">Create an account</a></p>
        </div>
    </div>

<script>
document.getElementById("loginForm").addEventListener("submit", function(e) {
    e.preventDefault();

    const emailInput = document.getElementById("userEmail").value.trim();
    const passInput = document.getElementById("userPass").value;

    /** * LOGIC FOR DATABASE CONNECTION:
     * In a real MySQL setup, you would use fetch() to send these credentials 
     * to a PHP/NodeJS script that queries: 
     * SELECT * FROM users WHERE email = emailInput AND password = passInput;
     */

    // FOR NOW: We simulate the check using the 'ayur_users' we registered in MySQL
    const users = JSON.parse(localStorage.getItem('ayur_users')) || [];

    // Find the user in our simulated 'users' table
    const foundUser = users.find(u => 
        u.email === emailInput && u.password === passInput
    );

    if (!foundUser) {
        alert("Invalid Email or Password! Please register if you haven't.");
        return;
    }

    // Save the user object to the session so the dashboard can greet them by 'full_name'
    localStorage.setItem('user', JSON.stringify(foundUser));


    if (foundUser.role === 'doctor') {
        window.location.href = "DoctorDashboard.html";
    } else if (foundUser.role === 'patient') {
        window.location.href = "UserDashboard.html";
    }
});
</script>
</body>
</html>